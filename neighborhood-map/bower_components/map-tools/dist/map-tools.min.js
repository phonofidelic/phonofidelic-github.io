/* map-tools.js 1.3.0 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function t(n,r,e){function o(i,s){if(!r[i]){if(!n[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=r[i]={exports:{}};n[i][0].call(c.exports,function(t){var r=n[i][1][t];return o(r?r:t)},c,c.exports,t,n,r,e)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<e.length;i++)o(e[i]);return o}({1:[function(t){"use strict";window.mapTools=t("map-tools/index")(window)},{"map-tools/index":12}],2:[function(t,n){var r=t("topojson"),e=t("map-tools/utils");n.exports=function(n,o){"use strict";function a(t,n){var r,a;for(a in t)if(t.hasOwnProperty(a)){r=t[a];var i=e.createUid();r.uid=i;var s=r.k;r.k.uid=i,Object.defineProperty(r,"data",{value:s,enumerable:!0,writable:!1,configurable:!1}),n&&(n.filters&&(o.json.filter||u(n.filters),o.json.crossfilter.add([r])),n.style&&o.instance.data.overrideStyle(r,n.style)),o.json.all[r.data.uid]=r}}function i(t,e){var i,s,u,f;for(f in e)e.hasOwnProperty(f)&&(i=e[f],s=r.feature(t,t.objects[i.object]),u=o.instance.data.addGeoJson(s),a(u,i),n.mapTools.maps[o.id].json.all[i.object]=u);return u}function s(t,n){var r=o.instance.data.addGeoJson(t,n);return a(r,n),r}var u=t("map-tools/addFilter")(n,o,"json");return{addGeoJson:s,addTopoJson:i}}},{"map-tools/addFilter":3,"map-tools/utils":20,topojson:23}],3:[function(t,n){var r=t("crossfilter"),e=t("map-tools/utils");n.exports=function(t,n,o){"use strict";function a(t){n[o].crossfilter=n[o].crossfilter||r([]),n[o].filter=n[o].filter||{};var a,i;"string"==typeof t&&(t=[t]);for(a in t)t.hasOwnProperty(a)&&(i=t[a],"string"==typeof i?n[o].filter[i]=n[o].crossfilter.dimension(e.defaultDimension(i)):n[o].filter[Object.keys(i)[0]]=n[o].crossfilter.dimension(i[Object.keys(i)[0]]))}return a}},{crossfilter:22,"map-tools/utils":20}],4:[function(t,n){var r=t("map-tools/config");n.exports=function(n,e){"use strict";function o(t){return t.el?n.document.querySelector(t.el):t.id?n.document.getElementById(t.id):void 0}function a(t,a){a=a||function(){};var i=u.mapOptions(t);if(t.id=t.id||t.el.substring(1),e.id=t.id,e.options=t,e.instance=new n.google.maps.Map(o(t),i),e.events=[],t.on){var s;for(s in t.on)t.on.hasOwnProperty(s)&&(r.customEvents.indexOf(s)>-1&&e.events.push(s),n.google.maps.event.addListener(e.instance,s,t.on[s]))}e.infoWindow=!1,e.templates={infoWindow:{},panel:{}},e.uid=t.uid,n.mapTools.maps[e.id].instance=e.instance,n.google.maps.event.addListenerOnce(e.instance,"idle",function(){a(!1,e)})}function i(t,n){return!t||t&&"object"!=typeof t?(n(new Error("You must pass a valid first parameter: options")),!1):t.id||t.el?t.lat&&t.lng?!0:(n(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(n(new Error('You must pass an "id" or a "el" property values')),!1)}function s(t,r){if(i(t,r)){var o=t.id||t.el.substring(1);if(n.mapTools.maps=n.mapTools.maps||{},n.mapTools.maps[o]){var s="There is already another Map using the same id: "+o;return r(new Error(s)),!1}n.mapTools.maps[o]={create:function(){a(this.arguments,r)},arguments:t},n.mapTools.maps[o].markers=n.mapTools.maps[o].markers||{all:{},tags:{},dataChanged:!1},n.mapTools.maps[o].json=n.mapTools.maps[o].json||{all:{},dataChanged:!1},e.markers=n.mapTools.maps[o].markers,e.json=n.mapTools.maps[o].json,t.async!==!1||t.sync===!0?u.load(o,t):n.mapTools.maps[o].create()}}var u=t("map-tools/gmaps.js")(n);return{load:s}}},{"map-tools/config":8,"map-tools/gmaps.js":11}],5:[function(t,n){var r=t("map-tools/utils"),e=t("crossfilter");n.exports=function(n,o){"use strict";function a(t,n){var r;for(r in n)n.hasOwnProperty(r)&&(n.filters||(t[r]=n[r]))}function i(t,r){t.move&&r.setAnimation(n.google.maps.Animation[t.move.toUpperCase()]),t.infoWindow&&p.addEvents(r,t.infoWindow,o.instance),t.on&&c(t,r),t.callback&&t.callback(r)}function s(t,r){if(t.map=o.instance,t.position=new n.google.maps.LatLng(t.lat,t.lng),r&&a(t,r),t.data=t.data||{},t.data._self=t,u(t),o.markers.all[t.uid])return!1;r&&r.filters&&(n.mapTools.maps[o.id].markers.filter||d(r.filters));var s=new n.google.maps.Marker(t);return o.markers.crossfilter=o.markers.crossfilter||e([]),o.markers.filter=o.markers.filter||{},o.markers.crossfilter.add([s]),i(t,s),o.markers.all=n.mapTools.maps[o.id].markers.all||{},o.markers.all[t.uid]=s,t.tags&&f(t,s),s}function u(t){o.uid&&t[o.uid]&&(t.data.uid=t[o.uid],t.uid=t.data.uid),t.data.uid&&!t.uid&&(t.uid=t.data.uid),t.uid||(t.data.uid=r.createUid(),t.uid=t.data.uid)}function f(t,n){if(r.isArray(t.tags)){var e,a;for(e in t.tags)t.tags.hasOwnProperty(e)&&(a=t.tags[e],o.markers.tags[a]=o.markers.tags[a]||{},o.markers.tags[a][n.data.uid]=n)}else o.markers.tags[t.tags]=o.markers.tags[t.tags]||{},o.markers.tags[t.tags][n.data.uid]=n}function c(t,r){var e;for(e in t.on)t.on.hasOwnProperty(e)&&n.google.maps.event.addListener(r,e,t.on[e])}function l(t,n){if(r.isArray(t)){if(t.length>=1){var e,a=[];for(var i in t)t.hasOwnProperty(i)&&(e=s(t[i],n),a.push(e));return o.markers.dataChanged=!0,a}return[]}return o.markers.dataChanged=!0,s(t,n)}var p=t("map-tools/infoWindow")(n,o),d=t("map-tools/addFilter")(n,o,"markers");return l}},{crossfilter:22,"map-tools/addFilter":3,"map-tools/infoWindow":13,"map-tools/utils":20}],6:[function(t,n){var r=t("map-tools/config");n.exports=function(n,e){"use strict";function o(t){return t.toUpperCase().match(/\S+/g).join("_")}function a(t){return t.replace(/-(.)/g,function(t,n){return n.toUpperCase()})}function i(t){var r=n.document.createElement("div");return r.innerHTML=t,r}function s(t,s){function f(){if(t.position&&(t.position=o(t.position),c=n.google.maps.ControlPosition[t.position]),"object"==typeof t.style)for(d in t.style)if(t.style.hasOwnProperty(d)){var r=a(d);l.style[r]=t.style[d]}if(t.events)for(p in t.events)if(t.events.hasOwnProperty(p)){var i=p.match(/\S+/g),u=i.splice(-1),f=i.join(" "),m=l.querySelectorAll(f);[].forEach.call(m,function(r){n.google.maps.event.addDomListener(r,u,t.events[p])})}e.instance.controls[c].push(l),e.panels=e.panels||{},e.panels[c]=l,s(!1,l)}s=s||function(){};var c,l,p,d;return t.position=t.position||r.panelPosition,t.templateURL?void u("panel",t.templateURL,function(t,n){return t?(s(t),!1):(l=new i(n),f())}):(l="string"==typeof t.template?new i(t.template):t.template,f())}var u=t("map-tools/template")(n,e);return s}},{"map-tools/config":8,"map-tools/template":16}],7:[function(t,n){n.exports=function(t,n){function r(r,e){var o;o=r&&e?new t.google.maps.LatLng(r,e):new t.google.maps.LatLng(n.options.lat,n.options.lng),n.instance.setCenter(o)}return r}},{}],8:[function(t,n){"use strict";n.exports={version:"3.18",url:"//maps.googleapis.com/maps/api/js",zoom:8,customMapOptions:["id","lat","lng","type","uid"],customMarkerOptions:["lat","lng","move","infoWindow","on","callback","tags"],panelPosition:"TOP_LEFT",customInfoWindowOptions:["open","close"],customEvents:["marker_visibility_changed"]}},{}],9:[function(t,n){var r=t("map-tools/utils");n.exports=function(n,e,o){"use strict";function a(t){var n,r;for(n in t)t.hasOwnProperty(n)&&(r=t[n],e[o].dataChanged===!0?(r.dispose(),f(n)):r.filterAll())}function i(t){if(r.isArray(t)&&1===t.length&&(t=t[0]),"string"==typeof t)return e[o].tags[t]?r.toArray(e[o].tags[t]):[];var n=s(t);return"object"==typeof n&&(n=r.toArray(n)),n}function s(t){for(var n,a=0;a<t.length-1;a++){var i=t[a],s=t[parseInt(a)+parseInt(1)];n=r.getCommonObject(e[o].tags[i],e[o].tags[s])}return n}function u(t,n){if("undefined"==typeof t&&"undefined"==typeof n)return r.toArray(e[o].all);var s,u,l,p;if("string"==typeof t)s=t;else if(s=Object.keys(t)[0],p=t[s],"tags"===s)return i(p);a(e[o].filter),e[o].filter[s]||f(s),u=n&&n.order&&c[n.order]?c[n.order]:c[Object.keys(c)[0]],l=n&&n.limit?n.limit:1/0,"undefined"==typeof p&&(p=null);var d=e[o].filter[s].filter(p)[u](l);return e[o].dataChanged=!1,1===l?d[0]:d}var f=t("map-tools/addFilter")(n,e,o),c={ASC:"top",DESC:"bottom"};return u}},{"map-tools/addFilter":3,"map-tools/utils":20}],10:[function(t,n){"use strict";n.exports=function(t,n){function r(r){return r.data&&r.data.uid?r:r.uid&&t.mapTools.maps[n.id].markers.all[r.uid]?t.mapTools.maps[n.id].markers.all[r.uid]:void 0}return r}},{}],11:[function(t,n){var r=t("map-tools/config"),e=t("map-tools/utils");n.exports=function(t){"use strict";function n(n,e){var o=e.version||r.version,a=t.document.createElement("script");return a.type="text/javascript",a.src=r.url+"?v="+o+"&callback=mapTools.maps."+n+".create",t.document.body.appendChild(a)}function o(n){var o=e.clone(n,r.customMapOptions);return o.zoom=n.zoom||r.zoom,n.lat&&n.lng&&(o.center=new t.google.maps.LatLng(n.lat,n.lng)),n.type&&(o.mapTypeId=t.google.maps.MapTypeId[n.type]||!1),o}return{load:n,mapOptions:o}}},{"map-tools/config":8,"map-tools/utils":20}],12:[function(t,n){var r=function(){function n(n,r){var e=this;this.addMarker=t("map-tools/addMarker")(window,e),this.removeMarker=t("map-tools/removeMarker")(window,e),this.resetMarker=t("map-tools/resetMarker")(window,e),this.addTopoJson=t("map-tools/addFeature")(window,e).addTopoJson,this.addGeoJson=t("map-tools/addFeature")(window,e).addGeoJson,this.updateFeature=t("map-tools/updateFeature")(window,e),this.addPanel=t("map-tools/addPanel")(window,e),this.updateMarker=t("map-tools/updateMarker")(window,e).update,this.findFeature=t("map-tools/filter")(window,e,"json"),this.findMarker=t("map-tools/filter")(window,e,"markers"),this.updateMap=t("map-tools/updateMap")(window,e),this.center=t("map-tools/center")(window,e);var o=t("map-tools/addMap")(window,e);return window.onload=o.load(n,r),this}return n.prototype.zoom=function(t){return"undefined"==typeof t?this.instance.getZoom():void this.instance.setZoom(t)},n.prototype.locate=function(){var t=this.instance.getCenter();return{lat:t.lat(),lng:t.lng()}},n}();n.exports=function(){return r}},{"map-tools/addFeature":2,"map-tools/addMap":4,"map-tools/addMarker":5,"map-tools/addPanel":6,"map-tools/center":7,"map-tools/filter":9,"map-tools/removeMarker":14,"map-tools/resetMarker":15,"map-tools/updateFeature":17,"map-tools/updateMap":18,"map-tools/updateMarker":19}],13:[function(t,n){var r=t("map-tools/utils"),e=t("map-tools/config");n.exports=function(t,n){"use strict";function o(e,o,a){var i=!1;o.infoWindow.content&&(o.infoWindow.content.indexOf("{")>-1&&(i=a.content.replace(/\{(\w+)\}/g,function(t,n){return o.data[n]||""})),i=i||o.infoWindow.content);var s=r.clone(a);s.content=i,n.infoWindow=new t.google.maps.InfoWindow(s),n.infoWindow.open(e,o)}function a(t,n,r){s(),o(t,n,r)}function i(t){var n=t.getMap();return null!==n&&"undefined"!=typeof n}function s(){clearTimeout(f),n.infoWindow&&i(n.infoWindow)&&n.infoWindow.close()}function u(o,u,c){var l=r.prepareOptions(u,e.customInfoWindowOptions),p=l.custom&&l.custom.open&&l.custom.open.on?l.custom.open.on:"click",d=l.custom&&l.custom.close&&l.custom.close.on?l.custom.close.on:"click";p===d?t.google.maps.event.addListener(o,p,function(){n.infoWindow&&i(n.infoWindow)?s():a(c,o,l.defaults)}):(t.google.maps.event.addListener(o,p,function(){a(c,o,l.defaults)}),t.google.maps.event.addListener(o,d,function(){l.custom.close.duration?f=setTimeout(function(){s()},l.custom.close.duration):s()}))}var f=!1;return{addEvents:u}}},{"map-tools/config":8,"map-tools/utils":20}],14:[function(t,n){n.exports=function(n,r){"use strict";function e(t){var n,r;for(r in t)t.hasOwnProperty(r)&&(n=t[r],a(i(n)))}function o(t){"undefined"==typeof t&&e(r.markers.all);var n=Object.prototype.toString.call(t);return"[object Object]"===n?a(i(t)):void("[object Array]"===n&&e(t))}function a(t){t.setMap(null),delete n.mapTools.maps[r.id].markers.all[t.data.uid]}var i=t("map-tools/findMarkerById")(n,r);return o}},{"map-tools/findMarkerById":10}],15:[function(t,n){var r=t("map-tools/utils"),e=t("map-tools/config");n.exports=function(n,o){"use strict";function a(t,n){var r;for(r in t)t.hasOwnProperty(r)&&u(t[r],n)}function i(t,n){var r,e=Object.prototype.toString.call(t);return"[object Object]"===e&&(r=u(f(t),n)),"[object Array]"===e&&(r=a(t,n)),o.markers.dataChanged=!0,r}function s(t,n){var r,e={},o=Object.prototype.toString.call(n);if("[object String]"===o&&(e[n]=t.data._self[n]),"[object Array]"===o)for(r in n)n.hasOwnProperty(r)&&(e[n[r]]=t.data._self[n[r]]);return e}function u(t,n){var o=r.prepareOptions(s(t,n),e.customMarkerOptions);return c.customUpdate(t,o),t}var f=t("map-tools/findMarkerById")(n,o),c=t("map-tools/updateMarker")(n,o);return i}},{"map-tools/config":8,"map-tools/findMarkerById":10,"map-tools/updateMarker":19,"map-tools/utils":20}],16:[function(t,n){n.exports=function(t,n){"use strict";function r(t,r,e){if(n.templates[t][r])return n.templates[t][r];var o=new XMLHttpRequest;o.open("GET",r),o.onload=function(){4===o.readyState&&(200===o.status?(n.templates[t][r]=o.responseText,e(!1,o.responseText)):o.onerror())},o.onerror=function(){e(new Error(o.statusText))},o.send(null)}return r}},{}],17:[function(t,n){n.exports=function(t,n){"use strict";function r(t,r){if("function"==typeof r){var e=r.call(t);return n.instance.data.overrideStyle(t,e)}n.instance.data.overrideStyle(t,r)}function e(r,e){return r.data&&r.data.uid?a(r,e):r.uid&&t.mapTools.maps[n.id].json&&t.mapTools.maps[n.id].json.all[r.uid]?a(t.mapTools.maps[n.id].json.all[r.uid],e):void 0}function o(t,n){var r=Object.prototype.toString.call(t);if("[object Array]"===r){var o,a;for(a in t)t.hasOwnProperty(a)&&(o=t[a],e(o,n))}"[object Object]"===r&&e(t,n)}function a(t,n){n.style&&r(t,n.style)}return o}},{}],18:[function(t,n){n.exports=function(n,r){"use strict";function e(t){var n=o.mapOptions(t);return r.instance.setOptions(n)}var o=t("map-tools/gmaps.js")(n);return e}},{"map-tools/gmaps.js":11}],19:[function(t,n){var r=t("map-tools/utils"),e=t("map-tools/config");n.exports=function(n,o){"use strict";function a(t){if(r.isArray(t.tags)){var n,e;for(n in t.tags)t.tags.hasOwnProperty(n)&&(e=t.tags[n],delete o.markers.tags[e][t.data.uid])}else delete o.markers.tags[t.tags][t.data.uid]}function i(t,n){if(r.isArray(n.custom.tags)){var e,a;for(e in n.custom.tags)a=n.custom.tags[e],o.markers.tags[a]=o.markers.tags[a]||{},o.markers.tags[a][t.data.uid]=t}else o.markers.tags[n.custom.tags]=o.markers.tags[n.custom.tags]||{},o.markers.tags[n.custom.tags][t.data.uid]=t;t.tags=n.custom.tags}function s(t,n){a(t),i(t,n)}function u(t,r){return r.custom&&(r.custom.move&&t.setAnimation(n.google.maps.Animation[r.custom.move.toUpperCase()]),r.custom.lat&&r.custom.lng&&t.setPosition(new n.google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.infoWindow&&r.custom.infoWindow.content&&(t.infoWindow.content=r.custom.infoWindow.content),r.custom.tags&&s(t,r)),r.defaults&&t.setOptions(r.defaults),t}function f(t,n){var r,e,o,a=[];for(o in t)t.hasOwnProperty(o)&&(r=t[o],e=u(p(r),n),a.push(e));return a}function c(){var t,r=0;for(t in o.markers.all)o.markers.all[t].visible&&r++;n.google.maps.event.trigger(o.instance,"marker_visibility_changed",r)}function l(a,i){var s=!1,l=r.prepareOptions(i,e.customMarkerOptions);l.defaults&&l.defaults.hasOwnProperty("visible")&&o.events.indexOf("marker_visibility_changed")>-1&&(s=!0);var d,m=Object.prototype.toString.call(a);if("[object Object]"===m)if(1===Object.keys(a).length&&a.tags){var v=t("map-tools/filter")(n,o,"markers");d=f(v(a),l)}else d=u(p(a),l);return"[object Array]"===m&&(d=f(a,l)),s&&c(),o.markers.dataChanged=!0,d}var p=t("map-tools/findMarkerById")(n,o);return{update:l,customUpdate:u}}},{"map-tools/config":8,"map-tools/filter":9,"map-tools/findMarkerById":10,"map-tools/utils":20}],20:[function(t,n){"use strict";function r(t,n){var e,o,a;e=Array.isArray(t)?[]:{};for(a in t)t.hasOwnProperty(a)&&(!n||n&&-1===n.indexOf(a))&&(o=t[a],e[a]="object"==typeof o?r(o):o);return e}function e(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n,r;return n=16*Math.random()|0,r="x"===t?n:3&n|8,r.toString(16)})}function o(t,n){var r,e={};for(r in t)t.hasOwnProperty(r)&&(n.indexOf(r)>-1?(e.custom=e.custom||{},e.custom[r]=t[r]):(e.defaults=e.defaults||{},e.defaults[r]=t[r]));return e}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return Object.keys(t).map(function(n){return t[n]})}function s(t){return function(n){return"undefined"==typeof n.data[t]&&"undefined"!=typeof n[t]?n[t]:"undefined"==typeof n.data[t]&&"undefined"==typeof n[t]?null:n.data[t]}}function u(t,n){var r={};for(var e in t)if(t.hasOwnProperty(e)){var o=n[e];"undefined"!=typeof o&&(r[e]=o)}return r}n.exports={clone:r,createUid:e,prepareOptions:o,isArray:a,toArray:i,defaultDimension:s,getCommonObject:u}},{}],21:[function(t,n,r){!function(t){function n(t){return t}function r(t,n){for(var r=0,e=n.length,o=new Array(e);e>r;++r)o[r]=t[n[r]];return o}function e(t){function n(n,r,e,o){for(;o>e;){var a=e+o>>>1;t(n[a])<r?e=a+1:o=a}return e}function r(n,r,e,o){for(;o>e;){var a=e+o>>>1;r<t(n[a])?o=a:e=a+1}return e}return r.right=r,r.left=n,r}function o(t){function n(t,n,r){for(var o=r-n,a=(o>>>1)+1;--a>0;)e(t,a,o,n);return t}function r(t,n,r){for(var o,a=r-n;--a>0;)o=t[n],t[n]=t[n+a],t[n+a]=o,e(t,1,a,n);return t}function e(n,r,e,o){for(var a,i=n[--o+r],s=t(i);(a=r<<1)<=e&&(e>a&&t(n[o+a])>t(n[o+a+1])&&a++,!(s<=t(n[o+a])));)n[o+r]=n[o+a],r=a;n[o+r]=i}return n.sort=r,n}function a(t){function n(n,e,o,a){var i,s,u,f,c=new Array(a=Math.min(o-e,a));for(s=0;a>s;++s)c[s]=n[e++];if(r(c,0,a),o>e){i=t(c[0]);do(u=t(f=n[e])>i)&&(c[0]=f,i=t(r(c,0,a)[0]));while(++e<o)}return c}var r=o(t);return n}function i(t){function n(n,r,e){for(var o=r+1;e>o;++o){for(var a=o,i=n[o],s=t(i);a>r&&t(n[a-1])>s;--a)n[a]=n[a-1];n[a]=i}return n}return n}function s(t){function n(t,n,o){return(T>o-n?e:r)(t,n,o)}function r(r,e,o){var a,i=(o-e)/6|0,s=e+i,u=o-1-i,f=e+o-1>>1,c=f-i,l=f+i,p=r[s],d=t(p),m=r[c],v=t(m),g=r[f],h=t(g),y=r[l],w=t(y),k=r[u],x=t(k);d>v&&(a=p,p=m,m=a,a=d,d=v,v=a),w>x&&(a=y,y=k,k=a,a=w,w=x,x=a),d>h&&(a=p,p=g,g=a,a=d,d=h,h=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),d>w&&(a=p,p=y,y=a,a=d,d=w,w=a),h>w&&(a=g,g=y,y=a,a=h,h=w,w=a),v>x&&(a=m,m=k,k=a,a=v,v=x,x=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),w>x&&(a=y,y=k,k=a,a=w,w=x,x=a);var O=m,b=v,j=y,E=w;r[s]=p,r[c]=r[e],r[f]=g,r[l]=r[o-1],r[u]=k;var M=e+1,P=o-2,A=E>=b&&b>=E;if(A)for(var T=M;P>=T;++T){var L=r[T],C=t(L);if(b>C)T!==M&&(r[T]=r[M],r[M]=L),++M;else if(C>b)for(;;){var S=t(r[P]);{if(!(S>b)){if(b>S){r[T]=r[M],r[M++]=r[P],r[P--]=L;break}r[T]=r[P],r[P--]=L;break}P--}}}else for(var T=M;P>=T;T++){var L=r[T],C=t(L);if(b>C)T!==M&&(r[T]=r[M],r[M]=L),++M;else if(C>E)for(;;){var S=t(r[P]);{if(!(S>E)){b>S?(r[T]=r[M],r[M++]=r[P],r[P--]=L):(r[T]=r[P],r[P--]=L);break}if(P--,T>P)break}}}if(r[e]=r[M-1],r[M-1]=O,r[o-1]=r[P+1],r[P+1]=j,n(r,e,M-1),n(r,P+2,o),A)return r;if(s>M&&P>u){for(var _,S;(_=t(r[M]))<=b&&_>=b;)++M;for(;(S=t(r[P]))<=E&&S>=E;)--P;for(var T=M;P>=T;T++){var L=r[T],C=t(L);if(b>=C&&C>=b)T!==M&&(r[T]=r[M],r[M]=L),M++;else if(E>=C&&C>=E)for(;;){var S=t(r[P]);{if(!(E>=S&&S>=E)){b>S?(r[T]=r[M],r[M++]=r[P],r[P--]=L):(r[T]=r[P],r[P--]=L);break}if(P--,T>P)break}}}}return n(r,M,P+1)}var e=i(t);return n}function u(t){for(var n=new Array(t),r=-1;++r<t;)n[r]=0;return n}function f(t,n){for(var r=t.length;n>r;)t[r++]=0;return t}function c(t,n){if(n>32)throw new Error("invalid array width!");return t}function l(t,n){return function(r){var e=r.length;return[t.left(r,n,0,e),t.right(r,n,0,e)]}}function p(t,n){var r=n[0],e=n[1];return function(n){var o=n.length;return[t.left(n,r,0,o),t.left(n,e,0,o)]}}function d(t){return[0,t.length]}function m(){return null}function v(){return 0}function g(t){return t+1}function h(t){return t-1}function y(t){return function(n,r){return n+ +t(r)}}function w(t){return function(n,r){return n-t(r)}}function k(){function t(t){var n=E,r=t.length;return r&&(k=k.concat(t),A=_(A,E+=r),C.forEach(function(e){e(t,n,r)})),c}function e(){for(var t=x(E,E),n=[],r=0,e=0;E>r;++r)A[r]?t[r]=e++:n.push(r);T.forEach(function(t){t(0,[],n)}),S.forEach(function(n){n(t)});for(var o,r=0,e=0;E>r;++r)(o=A[r])&&(r!==e&&(A[e]=o,k[e]=k[r]),++e);for(k.length=e;E>e;)A[--E]=0}function i(t){function e(n,e,o){Y=n.map(t),H=V(O(o),0,o),Y=r(Y,H);var a,i=$(Y),s=i[0],u=i[1];if(Z)for(a=0;o>a;++a)Z(Y[a],a)||(A[H[a]+e]|=K);else{for(a=0;s>a;++a)A[H[a]+e]|=K;for(a=u;o>a;++a)A[H[a]+e]|=K}if(!e)return N=Y,R=H,rn=s,void(en=u);var f=N,c=R,l=0,p=0;for(N=new Array(E),R=x(E,E),a=0;e>l&&o>p;++a)f[l]<Y[p]?(N[a]=f[l],R[a]=c[l++]):(N[a]=Y[p],R[a]=H[p++]+e);for(;e>l;++l,++a)N[a]=f[l],R[a]=c[l];for(;o>p;++p,++a)N[a]=Y[p],R[a]=H[p]+e;i=$(N),rn=i[0],en=i[1]}function i(t,n,r){tn.forEach(function(t){t(Y,H,n,r)}),Y=H=null}function u(t){for(var n,r=0,e=0;E>r;++r)A[n=R[r]]&&(r!==e&&(N[e]=N[r]),R[e]=t[n],++e);for(N.length=e;E>e;)R[e++]=0;var o=$(N);rn=o[0],en=o[1]}function f(t){var n=t[0],r=t[1];if(Z)return Z=null,G(function(t,e){return e>=n&&r>e}),rn=n,en=r,X;var e,o,a,i=[],s=[];if(rn>n)for(e=n,o=Math.min(rn,r);o>e;++e)A[a=R[e]]^=K,i.push(a);else if(n>rn)for(e=rn,o=Math.min(n,en);o>e;++e)A[a=R[e]]^=K,s.push(a);if(r>en)for(e=Math.max(n,en),o=r;o>e;++e)A[a=R[e]]^=K,i.push(a);else if(en>r)for(e=Math.max(rn,r),o=en;o>e;++e)A[a=R[e]]^=K,s.push(a);return rn=n,en=r,T.forEach(function(t){t(K,i,s)}),X}function c(t){return null==t?U():Array.isArray(t)?F(t):"function"==typeof t?I(t):L(t)}function L(t){return f(($=l(j,t))(N))}function F(t){return f(($=p(j,t))(N))}function U(){return f(($=d)(N))}function I(t){return $=d,G(Z=t),rn=0,en=E,X}function G(t){var n,r,e,o=[],a=[];for(n=0;E>n;++n)!(A[r=R[n]]&K)^!!(e=t(N[n],n))&&(e?(A[r]&=Q,o.push(r)):(A[r]|=K,a.push(r)));T.forEach(function(t){t(K,o,a)})}function q(t){for(var n,r=[],e=en;--e>=rn&&t>0;)A[n=R[e]]||(r.push(k[n]),--t);return r}function z(t){for(var n,r=[],e=rn;en>e&&t>0;)A[n=R[e]]||(r.push(k[n]),--t),e++;return r}function J(t){function r(n,r,e,o){function a(){++Y===D&&(y=W(y,B<<=1),U=W(U,B),D=b(B))}var c,l,p,d,v,g,h=F,y=x(Y,D),w=q,O=J,j=Y,M=0,P=0;for(X&&(w=O=m),F=new Array(Y),Y=0,U=j>1?_(U,E):x(E,D),j&&(p=(l=h[0]).key);o>P&&!((d=t(n[P]))>=d);)++P;for(;o>P;){for(l&&d>=p?(v=l,g=p,y[M]=Y,(l=h[++M])&&(p=l.key)):(v={key:d,value:O()},g=d),F[Y]=v;!(d>g||(U[c=r[P]+e]=Y,A[c]&Q||(v.value=w(v.value,k[c])),++P>=o));)d=t(n[P]);a()}for(;j>M;)F[y[M]=Y]=h[M++],a();if(Y>M)for(M=0;e>M;++M)U[M]=y[U[M]];c=T.indexOf(H),Y>1?(H=i,Z=u):(!Y&&V&&(Y=1,F=[{key:null,value:O()}]),1===Y?(H=s,Z=f):(H=m,Z=m),U=null),T[c]=H}function e(){if(Y>1){for(var t=Y,n=F,r=x(t,t),e=0,o=0;E>e;++e)A[e]&&(r[U[o]=U[e]]=1,++o);for(F=[],Y=0,e=0;t>e;++e)r[e]&&(r[e]=Y++,F.push(n[e]));if(Y>1)for(var e=0;o>e;++e)U[e]=r[U[e]];else U=null;T[T.indexOf(H)]=Y>1?(Z=u,H=i):1===Y?(Z=f,H=s):Z=H=m}else if(1===Y){if(V)return;for(var e=0;E>e;++e)if(A[e])return;F=[],Y=0,T[T.indexOf(H)]=H=Z=m}}function i(t,n,r){if(t!==K&&!X){var e,o,a,i;for(e=0,a=n.length;a>e;++e)A[o=n[e]]&Q||(i=F[U[o]],i.value=q(i.value,k[o]));for(e=0,a=r.length;a>e;++e)(A[o=r[e]]&Q)===t&&(i=F[U[o]],i.value=z(i.value,k[o]))}}function s(t,n,r){if(t!==K&&!X){var e,o,a,i=F[0];for(e=0,a=n.length;a>e;++e)A[o=n[e]]&Q||(i.value=q(i.value,k[o]));for(e=0,a=r.length;a>e;++e)(A[o=r[e]]&Q)===t&&(i.value=z(i.value,k[o]))}}function u(){var t,n;for(t=0;Y>t;++t)F[t].value=J();for(t=0;E>t;++t)A[t]&Q||(n=F[U[t]],n.value=q(n.value,k[t]))}function f(){var t,n=F[0];for(n.value=J(),t=0;E>t;++t)A[t]&Q||(n.value=q(n.value,k[t]))}function c(){return X&&(Z(),X=!1),F}function l(t){var n=I(c(),0,F.length,t);return G.sort(n,0,n.length)}function p(t,n,r){return q=t,z=n,J=r,X=!0,C}function d(){return p(g,h,v)}function O(t){return p(y(t),w(t),v)}function j(t){function n(n){return t(n.value)}return I=a(n),G=o(n),C}function M(){return j(n)}function P(){return Y}function L(){var t=T.indexOf(H);return t>=0&&T.splice(t,1),t=tn.indexOf(r),t>=0&&tn.splice(t,1),t=S.indexOf(e),t>=0&&S.splice(t,1),C}var C={top:l,all:c,reduce:p,reduceCount:d,reduceSum:O,order:j,orderNatural:M,size:P,dispose:L,remove:L};nn.push(C);var F,U,I,G,q,z,J,B=8,D=b(B),Y=0,H=m,Z=m,X=!0,V=t===m;return arguments.length<1&&(t=n),T.push(H),tn.push(r),S.push(e),r(N,R,0,E),d().orderNatural()}function B(){var t=J(m),n=t.all;return delete t.all,delete t.top,delete t.order,delete t.orderNatural,delete t.size,t.value=function(){return n()[0].value},t}function D(){nn.forEach(function(t){t.dispose()});var t=C.indexOf(e);return t>=0&&C.splice(t,1),t=C.indexOf(i),t>=0&&C.splice(t,1),t=S.indexOf(u),t>=0&&S.splice(t,1),M&=Q,U()}var N,R,Y,H,Z,X={filter:c,filterExact:L,filterRange:F,filterFunction:I,filterAll:U,top:q,bottom:z,group:J,groupAll:B,dispose:D,remove:D},K=~M&-~M,Q=~K,V=s(function(t){return Y[t]}),$=d,tn=[],nn=[],rn=0,en=0;return C.unshift(e),C.push(i),S.push(u),M|=K,(P>=32?!K:M&(1<<P)-1)&&(A=W(A,P<<=1)),e(k,0,E),i(k,0,E),X}function u(){function t(t,n){var r;if(!d)for(r=n;E>r;++r)A[r]||(u=f(u,k[r]))}function n(t,n,r){var e,o,a;if(!d){for(e=0,a=n.length;a>e;++e)A[o=n[e]]||(u=f(u,k[o]));for(e=0,a=r.length;a>e;++e)A[o=r[e]]===t&&(u=c(u,k[o]))}}function r(){var t;for(u=l(),t=0;E>t;++t)A[t]||(u=f(u,k[t]))}function e(t,n,r){return f=t,c=n,l=r,d=!0,p}function o(){return e(g,h,v)}function a(t){return e(y(t),w(t),v)}function i(){return d&&(r(),d=!1),u}function s(){var r=T.indexOf(n);return r>=0&&T.splice(r),r=C.indexOf(t),r>=0&&C.splice(r),p}var u,f,c,l,p={reduce:e,reduceCount:o,reduceSum:a,value:i,dispose:s,remove:s},d=!0;return T.push(n),C.push(t),t(k,0,E),o()}function f(){return E}var c={add:t,remove:e,dimension:i,groupAll:u,size:f},k=[],E=0,M=0,P=8,A=L(0),T=[],C=[],S=[];return arguments.length?t(arguments[0]):c}function x(t,n){return(257>n?L:65537>n?C:S)(t)}function O(t){for(var n=x(t,t),r=-1;++r<t;)n[r]=r;return n}function b(t){return 8===t?256:16===t?65536:4294967296}k.version="1.3.11",k.permute=r;var j=k.bisect=e(n);j.by=e;var E=k.heap=o(n);E.by=o;var M=k.heapselect=a(n);M.by=a;var P=k.insertionsort=i(n);P.by=i;var A=k.quicksort=s(n);A.by=s;var T=32,L=u,C=u,S=u,_=f,W=c;"undefined"!=typeof Uint8Array&&(L=function(t){return new Uint8Array(t)},C=function(t){return new Uint16Array(t)},S=function(t){return new Uint32Array(t)},_=function(t,n){if(t.length>=n)return t;var r=new t.constructor(n);return r.set(t),r},W=function(t,n){var r;switch(n){case 16:r=C(t.length);break;case 32:r=S(t.length);break;default:throw new Error("invalid array width!")}return r.set(t),r}),t.crossfilter=k}("undefined"!=typeof r&&r||this)},{}],22:[function(t,n){n.exports=t("./crossfilter").crossfilter},{"./crossfilter":21}],23:[function(t,r){!function(){function t(t,n){function r(n){var r,e=t.arcs[0>n?~n:n],o=e[0];return t.transform?(r=[0,0],e.forEach(function(t){r[0]+=t[0],r[1]+=t[1]})):r=e[e.length-1],0>n?[r,o]:[o,r]}function e(t,n){for(var r in t){var e=t[r];delete n[e.start],delete e.start,delete e.end,e.forEach(function(t){o[0>t?~t:t]=1}),s.push(e)}}var o={},a={},i={},s=[],u=-1;return n.forEach(function(r,e){var o,a=t.arcs[0>r?~r:r];a.length<3&&!a[1][0]&&!a[1][1]&&(o=n[++u],n[u]=r,n[e]=o)}),n.forEach(function(t){var n,e,o=r(t),s=o[0],u=o[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=u,e=a[u]){delete a[e.start];var f=e===n?n:n.concat(e);a[f.start=n.start]=i[f.end=e.end]=f}else a[n.start]=i[n.end]=n;else if(n=a[u])if(delete a[n.start],n.unshift(t),n.start=s,e=i[s]){delete i[e.end];var c=e===n?n:e.concat(n);a[c.start=e.start]=i[c.end=n.end]=c}else a[n.start]=i[n.end]=n;else n=[t],a[n.start=s]=i[n.end=u]=n}),e(i,a),e(a,i),n.forEach(function(t){o[0>t?~t:t]||s.push([t])}),s}function e(n,r,e){function o(t){var n=0>t?~t:t;(c[n]||(c[n]=[])).push({i:t,g:f})}function a(t){t.forEach(o)}function i(t){t.forEach(a)}function s(t){"GeometryCollection"===t.type?t.geometries.forEach(s):t.type in l&&(f=t,l[t.type](t.arcs))}var u=[];if(arguments.length>1){var f,c=[],l={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(t){t.forEach(i)}};s(r),c.forEach(arguments.length<3?function(t){u.push(t[0].i)}:function(t){e(t[0].g,t[t.length-1].g)&&u.push(t[0].i)})}else for(var p=0,d=n.arcs.length;d>p;++p)u.push(p);return{type:"MultiLineString",arcs:t(n,u)}}function o(r,e){function o(t){t.forEach(function(n){n.forEach(function(n){(i[n=0>n?~n:n]||(i[n]=[])).push(t)})}),u.push(t)}function a(t){return p(s(r,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var i={},u=[],f=[];return e.forEach(function(t){"Polygon"===t.type?o(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(o)}),u.forEach(function(t){if(!t._){var n=[],r=[t];for(t._=1,f.push(n);t=r.pop();)n.push(t),t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),u.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:f.map(function(e){var o=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].length<2&&o.push(t)})})}),o=t(r,o),(n=o.length)>1)for(var s,u=a(e[0][0]),f=0;f<n;++f)if(u===a(o[f])){s=o[0],o[0]=o[f],o[f]=s;break}return o})}}function a(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return i(t,n)})}:i(t,n)}function i(t,n){var r={type:"Feature",id:n.id,properties:n.properties||{},geometry:s(t,n)};return null==n.id&&delete r.id,r}function s(t,n){function r(t,n){n.length&&n.pop();for(var r,e=c[0>t?~t:t],o=0,a=e.length;a>o;++o)n.push(r=e[o].slice()),f(r,o);0>t&&u(n,a)}function e(t){return t=t.slice(),f(t,0),t}function o(t){for(var n=[],e=0,o=t.length;o>e;++e)r(t[e],n);return n.length<2&&n.push(n[0].slice()),n}function a(t){for(var n=o(t);n.length<4;)n.push(n[0].slice());return n}function i(t){return t.map(a)}function s(t){var n=t.type;return"GeometryCollection"===n?{type:n,geometries:t.geometries.map(s)}:n in l?{type:n,coordinates:l[n](t)}:null}var f=g(t.transform),c=t.arcs,l={Point:function(t){return e(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(e)},LineString:function(t){return o(t.arcs)},MultiLineString:function(t){return t.arcs.map(o)},Polygon:function(t){return i(t.arcs)},MultiPolygon:function(t){return t.arcs.map(i)}};return s(n)}function u(t,n){for(var r,e=t.length,o=e-n;o<--e;)r=t[o],t[o++]=t[e],t[e]=r}function f(t,n){for(var r=0,e=t.length;e>r;){var o=r+e>>>1;t[o]<n?r=o+1:e=o}return r}function c(t){function n(t,n){t.forEach(function(t){0>t&&(t=~t);var r=o[t];r?r.push(n):o[t]=[n]})}function r(t,r){t.forEach(function(t){n(t,r)})}function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,n)}):t.type in i&&i[t.type](t.arcs,n)}var o={},a=t.map(function(){return[]}),i={LineString:n,MultiLineString:r,Polygon:r,MultiPolygon:function(t,n){t.forEach(function(t){r(t,n)})}};t.forEach(e);for(var s in o)for(var u=o[s],c=u.length,l=0;c>l;++l)for(var p=l+1;c>p;++p){var d,m=u[l],v=u[p];(d=a[m])[s=f(d,v)]!==v&&d.splice(s,0,v),(d=a[v])[s=f(d,m)]!==m&&d.splice(s,0,m)}return a}function l(t,n){function r(t){a.remove(t),t[1][2]=n(t),a.push(t)}var e=g(t.transform),o=h(t.transform),a=v();return n||(n=d),t.arcs.forEach(function(t){for(var i,s,u=[],f=0,c=0,l=t.length;l>c;++c)s=t[c],e(t[c]=[s[0],s[1],1/0],c);for(var c=1,l=t.length-1;l>c;++c)i=t.slice(c-1,c+2),i[1][2]=n(i),u.push(i),a.push(i);for(var c=0,l=u.length;l>c;++c)i=u[c],i.previous=u[c-1],i.next=u[c+1];for(;i=a.pop();){var p=i.previous,d=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],p&&(p.next=d,p[2]=i[2],r(p)),d&&(d.previous=p,d[0]=i[0],r(d))}t.forEach(o)}),t}function p(t){for(var n,r=-1,e=t.length,o=t[e-1],a=0;++r<e;)n=o,o=t[r],a+=n[0]*o[1]-n[1]*o[0];return.5*a}function d(t){var n=t[0],r=t[1],e=t[2];return Math.abs((n[0]-e[0])*(r[1]-n[1])-(n[0]-r[0])*(e[1]-n[1]))}function m(t,n){return t[1][2]-n[1][2]}function v(){function t(t,n){for(;n>0;){var r=(n+1>>1)-1,o=e[r];if(m(t,o)>=0)break;e[o._=n]=o,e[t._=n=r]=t}}function n(t,n){for(;;){var r=n+1<<1,a=r-1,i=n,s=e[i];if(o>a&&m(e[a],s)<0&&(s=e[i=a]),o>r&&m(e[r],s)<0&&(s=e[i=r]),i===n)break;e[s._=n]=s,e[t._=n=i]=t}}var r={},e=[],o=0;return r.push=function(n){return t(e[n._=o]=n,o++),o},r.pop=function(){if(!(0>=o)){var t,r=e[0];return--o>0&&(t=e[o],n(e[t._=0]=t,0)),r}},r.remove=function(r){var a,i=r._;if(e[i]===r)return i!==--o&&(a=e[o],(m(a,r)<0?t:n)(e[a._=i]=a,i)),i},r}function g(t){if(!t)return y;var n,r,e=t.scale[0],o=t.scale[1],a=t.translate[0],i=t.translate[1];return function(t,s){s||(n=r=0),t[0]=(n+=t[0])*e+a,t[1]=(r+=t[1])*o+i}
}function h(t){if(!t)return y;var n,r,e=t.scale[0],o=t.scale[1],a=t.translate[0],i=t.translate[1];return function(t,s){s||(n=r=0);var u=(t[0]-a)/e|0,f=(t[1]-i)/o|0;t[0]=u-n,t[1]=f-r,n=u,r=f}}function y(){}var w={version:"1.6.18",mesh:function(t){return s(t,e.apply(this,arguments))},meshArcs:e,merge:function(t){return s(t,o.apply(this,arguments))},mergeArcs:o,feature:a,neighbors:c,presimplify:l};"function"==typeof define&&define.amd?define(w):"object"==typeof r&&r.exports?r.exports=w:this.topojson=w}()},{}]},{},[1]);